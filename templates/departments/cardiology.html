{% extends "base.html" %}

{% block title %}{{ department.name }} - Aarogya Hastha{% endblock %}

{% block content %}
<section class="department-banner" data-aos="fade-up" data-aos-offset="300" data-aos-easing="ease-in-sine">
    <div class="container">
        <div class="banner">
            {% if department.banner_path %}
                <img loading="lazy" src="{{ url_for('static', filename=department.banner_path) }}" alt="{{ department.name }}">
            {% else %}
                <img loading="lazy" src="/static/img/banners/default.jpg" alt="{{ department.name }}">
            {% endif %}
            <div class="text-box-1">
                <h1>{{ department.name }}</h1>
                <p>{{ department.description }}</p>
            </div>
        </div>
    </div>
</section>

<div class="container my-5">
 <ul class="nav nav-tabs" id="departmentTabs" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active fw-bold text-dark" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview-tab-pane" type="button" role="tab" aria-controls="overview-tab-pane" aria-selected="true">Overview</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link fw-bold text-dark" id="services-tab" data-bs-toggle="tab" data-bs-target="#services-tab-pane" type="button" role="tab" aria-controls="services-tab-pane" aria-selected="false">Our Services</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link fw-bold text-dark" id="specialists-tab" data-bs-toggle="tab" data-bs-target="#specialists-tab-pane" type="button" role="tab" aria-controls="specialists-tab-pane" aria-selected="false">Our Specialists</button>
    </li>
</ul>

    <div class="tab-content" id="departmentTabsContent">

        <div class="tab-pane fade show active" id="overview-tab-pane" role="tabpanel" aria-labelledby="overview-tab">
            <section data-aos="fade-up" class="py-4">
                {% if overview %}
                <blockquote class="blockquote blockquote-custom">
                    <p class="mb-0 mt-2">{{ overview.quote }}</p>
                    <div class="blockquote-footer mt-4 text-end">{{ overview.quote_author }}</div>
                </blockquote>
                <p>{{ overview.content }}</p>
                {% endif %}
            </section>
        </div>
        

<div class="tab-pane fade" id="services-tab-pane" role="tabpanel" aria-labelledby="services-tab">
    <section class="department-section py-4">
        <h2>Types of {{ department.name }} Care</h2>
        <div class="row g-4">
            {% for service in services %}
            <div class="col-md-6">
                <div class="card h-100 p-3">
                    {% if service.icon_path %}
                    <img src="{{ url_for('static', filename=service.icon_path) }}" alt="{{ service.title }}" class="card-img-top" style="max-width: 60px;">
                    {% endif %}
                    <div class="card-body">
                        <h4 class="card-title text-dark-blue">{{ service.title }}</h4>
                        {% if service.list_items %}
                        <ul class="card-text list-unstyled">
                            {% for item in service.get_list_items() %}
                            <li><i class="fas fa-check-circle text-success me-2"></i>{{ item }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                        <p class="card-text">{{ service.description }}</p>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
</div>

<div class="tab-pane fade" id="specialists-tab-pane" role="tabpanel" aria-labelledby="specialists-tab">
    <section class="py-4">
        <h2>Our Specialists</h2>
        <div id="specialists-list" class="appointment-section">
            <div class="row g-3">
                {% set ns = namespace(has_doctors=False) %}
                
                {% for doctor in doctors %}
                    {% if doctor.is_active %}
                        {% set ns.has_doctors = True %}
                        <div class="col-lg-6 specialist-item" data-specialist="{{ doctor.slug }}">
                            <div class="specialist-card">
                                <div class="img-box">
                                    {% if doctor.image_path %}
                                        <img class="img-fluid" src="{{ url_for('static', filename=doctor.image_path) }}" alt="{{ doctor.name }}">
                                    {% else %}
                                        <img class="img-fluid" src="{{ url_for('static', filename='img/default-doctor.jpg') }}" alt="No Image">
                                    {% endif %}
                                </div>
                                <div class="content">
                                    <h3>{{ doctor.name }}</h3>
                                    <h4>{{ doctor.specialization }}</h4>
                                    {% if doctor.day_from and doctor.day_to and doctor.time_from_hour %}
                                        <p class="details">
                                            <b>Timings:</b>
                                            {{ doctor.day_from }} - {{ doctor.day_to }},
                                            {{ doctor.time_from_hour }}:{{ doctor.time_from_min }} {{ doctor.time_from_ampm }} -
                                            {{ doctor.time_to_hour }}:{{ doctor.time_to_min }} {{ doctor.time_to_ampm }}
                                        </p>
                                    {% endif %}
                                    <a class="book-btn" target="_blank" href="{{ doctor.appointment_link or 'https://app.fyndbetter.com/ahh_apt' }}">
                                        BOOK APPOINTMENT
                                    </a>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}

                {% if not ns.has_doctors %}
                <div class="col-12">
                    <div class="alert alert-warning">
                        No specialists found for this department.
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </section>
</div>


<script>
    function showDescription(index) {
        let desc = document.getElementById("desc-" + index).innerHTML;
        document.getElementById("description-container").innerHTML = desc;
    }
</script>

<section data-aos-easing="ease-in-sine" class="service-carousel-section py-5">
    <div class="container d-flex justify-content-center">
        <div class="owl-carousel service-carousel">
            </div>
    </div>
</section>

<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="/static/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script src="/static/js/script.js"></script>
<script src="https://fyndbetter.com/chatbot/aarogya_chatbot"></script>
<script>
    $(".book-apt").on('click', function () {
        var url = $(this).data("url");
        window.open(url, '_blank');
    });
</script>
<a href="#" id="scrollToTopBtn" class="scroll-to-top-btn" title="Scroll to top" aria-label="Scroll to top">
    <i class="fa fa-arrow-up"></i>
</a>
<script> $(document).ready(function () { initDepartmentPageActions(); }) </script>
{% endblock %}